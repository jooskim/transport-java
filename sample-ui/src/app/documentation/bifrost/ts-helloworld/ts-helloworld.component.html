<h1>Hello World!</h1>

<p>To demonstrate the simplest possible use of the event bus, we will create a simple Angular component that simply
    talks to its self.</p>

<pre class="code"><code class="language-typescript" ngNonBindable>import &#123; Component, OnInit &#125; from '@angular/core';
import &#123; AbstractBase &#125; from '@vmw/bifrost/core';

@Component(&#123;
    selector: 'hello-world',
    template: `&#123;&#123;message&#125;&#125;`
&#125;)
export class HelloWorldComponent extends AbstractBase implements OnInit &#123;

    public message: string;

    constructor() &#123;
        super('HelloWorldComponent');
    &#125;

    ngOnInit() &#123;

        // define a channel to talk on.
        let myChannel = 'some-channel';

        // listen for requests on 'myChannel' and return a response.
        this.bus.respondOnce(myChannel)
            .generate(
                (request: string) => &#123;
                    this.log.info(`Request Received: $&#123;request&#125;, Sending Response...`);
                    return 'world';
                &#125;
            );

        this.log.info('Sending Request');

        // send request 'hello' on channel 'myChannel'.
        this.bus.requestOnce(myChannel, 'hello')
            .handle(
                (response: string) => &#123;
                    this.message = `hello $&#123;response&#125;`;
                &#125;
            );
    &#125;
&#125;</code></pre>

<p>The output of the component is pretty basic, see it running below:</p>

<appfab-tryitout-component>
  <ts-hello-world></ts-hello-world>
</appfab-tryitout-component>

<p>And a version using React:</p>

<pre class="code">
<code class="language-typescript" ngNonBindable>
import React, &#123; useState, useEffect &#125; from 'react';
import &#123; useBifrost &#125; from 'react-bifrost';

export default function HelloWorld(props: any) &#123;
    const [message, setMessage] = useState('');
    const bifrost = useBifrost();

    // define a channel to talk on.
    const myChannel = 'some-channel';

    useEffect(() => &#123;
        // listen for requests on 'myChannel' and return a response.
        bifrost.bus.respondOnce(myChannel).generate((request: string) => &#123;
            bifrost.log.info(`Request Received: $&#123;request&#125;, Sending Response...`);
            return 'world';
        &#125;);

        bifrost.log.info('Sending Request');

        // send request 'hello' on channel 'myChannel'.
        bifrost.bus.requestOnce(myChannel, 'hello').handle((response: string) => &#123;
            setMessage(`hello $&#123;response&#125;`);
        &#125;);
    &#125;, []);

    return &#60;div&#62;&#123;message&#125;&#60;/div&#62;;
&#125;
</code>
</pre>

<appfab-tryitout-component>
    <react-sample [component]="reactComponent"></react-sample>
</appfab-tryitout-component>

<p>
    In the above example, we set up a simple lambda to handle an inbound message (request). This responder uses the
    <code class="clr-code">respondOnce()</code> method
    to listen for a single request, this method returns an object of type <code class="clr-code">MessageResponder&lt;string&gt;</code>.
    Responders generate responses by
    using the <code class="clr-code">generate()</code> method. You simply pass in a lambda that accepts a request
    argument (in the case of this example <code class="clr-code">request: string</code>),
    and returns a response (in this example <code class="clr-code">'world'</code>).
</p>
<pre>
▫️️ <span class="console-purple">[Inf]:</span> <span class="console-pink">Sending Request</span>
▫️️ <span class="console-purple">[Inf]:</span> <span class="console-pink">Request Received: hello, Sending Response...</span>
</pre>
