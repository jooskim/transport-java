<h1>ModelGen - CLI</h1>

<h3>The Translation Engine for Service Specifications.</h3>

<p>
    In the suite of components that make up the <strong class="emphasis">Intent Compiler</strong> we call <strong
    class="emphasis">Sewing Machine</strong>, the role of <strong class="emphasis">ModelGen</strong> is to translate
    Service Adapter
    Specification Documents into Application Fabric specific bindings in a number of supported programming languages to
    be
    manifest as models and operations in the application space. This component is also the 4th stage of the compiler’s pipeline.
</p>

<hr/>

<h2>
    Specifications and Languages
</h2>

<p>
    <strong class="emphasis">ModelGen</strong> reads the Service Adapter Specification Documents output by <strong class="emphasis">ServGen</strong>
    using <strong class="emphasis">libswagger</strong> and creates models and operational interfaces to all detected Service Adapters,
    while hiding the <strong class="emphasis">bifröst</strong> event bus interfaces, so that developers only have to make
    procedural calls with asynchronous callback handlers that are simple to implement and maintain. Because all interfaces and
    models are autogenerated, changes to contracts are quickly exposed, making maintenace of downstream applications a breeze.
</p>
<p>
    At the time of writing this, <strong class="emphasis">ModelGen</strong> outputs models and operational interfaces using
    <strong class="emphasis">Typescript</strong>, however, because of the <strong class="emphasis">plugin</strong>
    architecture employed by all <strong class="emphasis">Sewing Machine</strong> components, additional languages
    can be supported with relative ease.
</p>

<p>
    At its core, ModelGen converts an abstraction of specifications as produced by <strong
    class="emphasis">ServGen</strong>, into models and operations in supportewd languages. In this sense, it is also a translation engine
    that is analogous to <strong class="emphasis">APIGen</strong>, except that, instead of creating bindings to API calls,
    <strong class="emphasis">ModelGen</strong> creates bindings to Service Adapter requests and responses.
</p>

<hr/>

<h2>
    Using ModelGen
</h2>

<p>
    The following is a detailed description of how to invoke ModelGen (obsolete and deprecated options have been
    excluded):
</p>

<pre class="code"><code class="language-json" ngNonBindable>Usage: Modelgen [-dDhrtvVw] [-b "$&#123;HOME&#125;/ui"] [-c "$&#123;PWD&#125;/src/config"]
                [-i value] [-l "typescript" | java] [-o "./java"] [-y "-api-doc.yaml"]

 -b, --root=$&#123;HOME&#125;/ui                 Project Root
 -c, --config-dir="$&#123;PWD&#125;/src/config"  Full path to Modelgen configuration files
 -d, --debug                           Debug Output
 -D, --detect-duplicates               Detect duplicate class declarations
 -F, --force                           Force overwrite
 -h, --help                            Display Help
 -i, --interface-dir="interfaces"      Directory for autogenerated Service Adapter Interface Documents
                                       relative to the project root
 -l, --language="typescript"           Codegen Language
 -o, --outdir="~/models"               Modelgen Output Folder
 -r, --recover                         Continue on error
 -t, --trace                           Trace Output
 -v, --verbose                         Verbose Output
 -V, --version                         Show Version
 -w, --no-warnings                     Turn off warnings</code></pre>

<table class="table table-noborder flag-table">
    <thead>
    <tr>
        <th class="left flag-header">Flag</th>
        <th>Description</th>
    </tr>
    </thead>
    <tbody>
    <tr>
        <td class="left flag">-b &lt;path&gt; | --root=&lt;path&gt;</td>
        <td class="flag-value">This option declares the absolute path to the root of the Project directory. All
            subsequent location
            specifications are relative to this root path. If this option is skipped, ModelGen defaults to <strong
                class="emphasis">$&#123;HOME&#125;/ui</strong> for
            historical reasons. Path specifications may include the "<code class="clr-code">~</code>" (tilde) character which will be replaced by the <strong
                class="emphasis">HOME</strong>
            folder of the invoking user, or "<code class="clr-code">~&lt;user&gt;</code>", which will be replaced by
            the <strong class="emphasis">HOME</strong> folder of the specified
            <strong class="emphasis">&lt;user&gt;.</strong>
        </td>

    </tr>
    <tr>
        <td class="left flag">-d | --debug</td>
        <td class="flag-value">
            Used by ModelGen developers to emit debug output.
        </td>
    </tr>
    <tr>
        <td class="left flag">-D | --detect-duplicates</td>
        <td class="flag-value">
            Sometimes several Service Adapters will express ownership of a class (e.g. <strong class="emphasis">Sddc</strong>),
            because the developer failed to use <strong class="emphasis">imports</strong> declarators in their Service Adapter
            Specification Documents, resulting in that class being instantiated multiple times among different Service Adapters,
            instead of a unique Service Adapter asserting ownership with the <strong class="emphasis">exports</strong>
            declarator, and other Service Adapters referring to that one instance.
            <br/><br/>
            With this option, <code class="clr-code">ModelGen</code> will detect the occurence of these duplicated classes
            and print out the offending Service Adapters and the classes they duplicate. These are only warnings, and execution
            will continue uninterrupted.
        </td>
    </tr>
    <tr>
        <td class="left flag">-F | --force</td>
        <td class="flag-value">
            This option is used to specify that even customized operations and models will be overwritten on execution.
            Use with caution. This is mainly for use by developers.
        </td>
    </tr>
    <tr>
        <td class="left flag">-h | --help</td>
        <td class="flag-value">
            Displays all the options recognized by ModelGen.
        </td>
    </tr>
    <tr>
        <td class="left flag">-i &lt;path&gt; | --interface-dir=&lt;path&gt;</td>
        <td class="flag-value">
            This option specifies the path to the directory where the Service Adapter Interface
            Documents from <strong class="emphasis">ServGen</strong> reside, relative to the project root.
        </td>
    </tr>

    <tr>
        <td class="left flag">-l "typescript" | --language="typescript";</td>
        <td class="flag-value">
            This option is used to specify the language plugin to be used for the output from ModelGen. Currently, the only
            valid plugin is: <strong class="emphasis">typescript</strong>.
        </td>
    </tr>

    <tr>
        <td class="left flag">-o &lt;output folder&gt; | --outdir=&lt;output folder&gt;</td>
        <td class="flag-value">
            This specifies the path to the root of the output folder within which sub folders for
            each Service Adapter will be autogenerated to contain their models and operations.
        </td>
    </tr>

    <tr>
        <td class="left flag">-r | --recover</td>
        <td class="flag-value">
            Used by ModelGen developers to continue processing even when a fatal error is encountered.
        </td>
    </tr>

    <tr>
        <td class="left flag">-t | --trace</td>
        <td class="flag-value">
            Used by ModelGen developers to emit trace level output.
        </td>
    </tr>

    <tr>
        <td class="left flag">-V | --version</td>
        <td class="flag-value">
            Displays ModelGen version.
        </td>
    </tr>

    <tr>
        <td class="left flag">-v | --verbose</td>
        <td class="flag-value">
            Used by ModelGen developers to emit verbose level output.
        </td>
    </tr>

    <tr>
        <td class="left flag">-w | --no-warnings</td>
        <td class="flag-value">
            option suppresses warning from ModelGen (not recommended, except while debugging, and overwhelmed by a stream
            of warnings).
        </td>
    </tr>

    </tbody>
</table>


<hr/>

<h2>
   Example Use
</h2>

<h3>
    VMC UI
</h3>
<pre class="code"><code class="language-bash" ngNonBindable>modlegen -b ~/ui -c ~/ui/src/config -i src/services/interfaces -o ~/ui/src/models</code></pre>

