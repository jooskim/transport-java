<h1>Service Adapter Specification</h1>

<h3>Specification Document: arrays.json</h3>

<p>
    By convention, <code class="clr-code">arrays.json</code> contains the specifications for generating language-neutral
    arrays of typed objects for internal use by the Service Adapter, either for customized code,
    or for custom tests. A later chapter will discuss in detail the autogenerated code.
</p>

<p>
    It should be noted that the autogenerated arrays are not exposed in the Service Adapter Interface (YAML), and therefore,
    such arrays are not directly accessible from the application layer. Moreover, arrays are currently not supported for
    Service Adapters written in Java.
    <br/><br/>
    Arrays are a legacy implementation which had hoped to be transportable across multiple languages. We are seeing
    problems in creating standalone arrays (not wrapped in a class) in languages other than Typescript, so it may be preferable to use
    <code class="clr-code">custom code</code> instead. In the meantime, we are investigating whether we can come
    up with an alternate solution.
</p>

<p>
    Here is an example of an array excerpted from the <strong class="emphasis">cloud-provider</strong> Service Adapter
    that is used for testing (mocks are described in a later chapter):
</p>

<pre class="code" ><code class="language-json" ngNonBindable>
&#123;
  "arrays": [
    &#123;
      "array": "CloudProviders",
      "type": "AwsCloudProvider",
      "imports": [
        &#123; "import": "AwsCloudProvider", "service": "cloud-provider" &#125;,
        &#123; "import": "CloudProviderMocks", "path": "../tests/cloud-provider.data.mock" &#125;
      ],
      "items": [
        &#123; "item": "CloudProviderMocks.MockZeroCloud()" &#125;,
        &#123; "item": "CloudProviderMocks.MockOneCloud()" &#125;,
        &#123; "item": "CloudProviderMocks.MockAWS()" &#125;
      ]
    &#125;
  ]
&#125;
</code></pre>
<p>
    In the above, we have specified that we want to create an array named <code class="clr-code">CloudProviders</code>
    that contains objects of "type" <code class="clr-code">AwsCloudProvider</code>.
    Below is a detailed description of the various properties for specifying an array:
</p>
<table class="table table-noborder flag-table">
    <thead>
    <tr>
        <th class="left flag-header">Property</th>
        <th>Description</th>
    </tr>
    </thead>
    <tbody>
    <tr>
        <td class="left flag">arrays</td>
        <td class="flag-value">This property specifies an array of custom arrays. These arrays are only for use within the Service
            Adapter or its custom tests. The instantiated array is not exposed in the Service Interface Document and is, therefore,
            not referable from the application layer.
        </td>
    </tr>
    <tr>
        <td class="left flag">array</td>
        <td class="flag-value">This property specifies the name of each array that is to be instantiated. This name is
            referable from the Service Adapter and its mocks and tests, but is not exposed in the Service Adapter Interface
            Document.
        </td>
    </tr>
    <tr>
        <td class="left flag">type</td>
        <td class="flag-value">This property specifies the "type" of the <strong class="emphasis">items</strong> in the array.
            The type specification uses <code class="clr-code">CommonType</code> described in previous chapters, however,
            <code class="clr-code">nested</code> is not permitted here since that would exceed the maximum nesting depth
            for a container (array is already a container).
        </td>
    </tr>
    <tr>
    <tr>
        <td class="left flag">imports</td>
        <td class="flag-value">Typically, in autogenerating an array, <strong class="emphasis">ServGen</strong> is able to infer the
            location where all references within the array are defined. In some cases, however, as in the example above, some help is
            required in the form of <code class="clr-code">import</code> specifications to determine the location of some definitions.
            <br/><br/>
            This property contains an array of identifiers to be searched for definitions. The identifier is declared using the
            <code class="clr-code">import</code> property, while the location is the Service Adapter where it is defined using
            the <code class="clr-code">service</code> property. In the above example, <strong class="emphasis">AwsCloudProvider</strong> is to be
            found in the <strong class="emphasis">cloud-provider</strong> Service Adapter. Ommision of the <code class="clr-code">service</code>
            property indicates that the symbol is to be searched for in the current Service Adapter. Instead of providing a location using the
            <code class="clr-code">service</code> property, it is also possible to provide an absolute or relative path to a file
            using the <code class="clr-code">path</code> property as shown in the above example for the identifier
            <code class="clr-code">CloudProviderMocks</code>.
        </td>
    </tr>
    <tr>
        <td class="left flag">items</td>
        <td class="flag-value">This property specifies an item to populate the array. The "type" for the <code class="clr-code">item</code>
            must conform to the description for it above.
        </td>
    </tr>
    </tbody>
</table>

<p>
    For Service Adapters written in Typescript, the example specification above results in the following code being autogenerated in
    the Service Adapter:
</p>

<pre class="code" ><code class="language-typescript" ngNonBindable>
import &#123; AwsCloudProvider &#125; from '../../AwsCloudProvider';
import &#123; CloudProviderMocks &#125; from '../tests/cloud-provider.data.mock';


// NOTE: CloudProviders can only be used internally in CloudProvider service. It will not be in the interface YAML.
export const CloudProviders: Array&lt;AwsCloudProvider&gt; = [
    CloudProviderMocks.MockZeroCloud(),
    CloudProviderMocks.MockOneCloud(),
    CloudProviderMocks.MockAWS()
];
</code></pre>

<hr/>

<p>
    That's it! This is all you need to specify custom arrays.
</p>
